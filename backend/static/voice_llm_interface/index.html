<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JARVIS AI | Voicyfy</title>

    <!-- Favicon –∏ PWA -->
    <link rel="icon" type="image/x-icon" href="/static/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="/static/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/static/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/static/favicon-16x16.png">
    <link rel="manifest" href="/static/manifest.json">
    <meta name="theme-color" content="#667eea">
    <meta name="description" content="JARVIS AI - –ì–æ–ª–æ—Å–æ–≤–æ–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π LLM">

    <!-- External CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Orbitron:wght@400;500;600;700;900&display=swap" rel="stylesheet">
    
    <!-- App CSS -->
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- –†–∞–Ω–Ω–µ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞ –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è overlay -->
    <script>
        (function() {
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.has('assistant')) {
                document.body.classList.add('embed-mode');
            }
        })();
    </script>

    <!-- START OVERLAY - –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –∫–ª–∏–∫ –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –∞—É–¥–∏–æ -->
    <div class="start-overlay" id="startOverlay">
        <div class="start-overlay-content">
            <div class="start-overlay-icon">
                <i class="fas fa-gem"></i>
            </div>
            <div class="start-overlay-title">JARVIS AI</div>
            <div class="start-overlay-subtitle">
                –ì–æ–ª–æ—Å–æ–≤–æ–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –Ω–∞ –±–∞–∑–µ Google Gemini —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π LLM
            </div>
            <button class="start-overlay-button" id="startButton">
                <i class="fas fa-microphone"></i>
                –ù–∞–∂–º–∏—Ç–µ —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å
            </button>
            <div class="start-overlay-hint">
                <i class="fas fa-info-circle"></i>
                –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞ –∏ –∑–≤—É–∫–∞
            </div>
        </div>
    </div>

    <!-- Overlay –¥–ª—è –º–æ–±–∏–ª—å–Ω–æ–≥–æ –º–µ–Ω—é -->
    <div class="sidebar-overlay" id="sidebar-overlay"></div>

    <!-- SIDEBAR NAVIGATION -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <a href="/" class="sidebar-logo">
                <div class="logo-icon">
                    <img src="/static/images/IMG_2820.PNG" alt="Voicyfy Logo" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                    <div style="display:none; width: 30px; height: 30px; border-radius: 0.5rem; background: linear-gradient(135deg, #8b5cf6, #6366f1); color: white; align-items: center; justify-content: center; font-size: 0.875rem;">
                        <i class="fas fa-robot"></i>
                    </div>
                </div>
                <span>Voicyfy</span>
            </a>
        </div>

        <nav class="sidebar-nav">
            <div class="sidebar-section">–û—Å–Ω–æ–≤–Ω–æ–µ</div>
            <a href="/static/dashboard.html" class="sidebar-nav-item">
                <i class="fas fa-home"></i> –î–∞—à–±–æ—Ä–¥
            </a>
            <a href="/static/agents.html" class="sidebar-nav-item">
                <i class="fas fa-robot"></i> OpenAI –∞–≥–µ–Ω—Ç—ã
            </a>
            <a href="/static/gemini-agents.html" class="sidebar-nav-item">
                <i class="fas fa-gem"></i> Gemini –∞–≥–µ–Ω—Ç—ã
            </a>
            <a href="/static/knowledge-base.html" class="sidebar-nav-item">
                <i class="fas fa-book"></i> –ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π
            </a>
            <a href="/static/telephony.html" class="sidebar-nav-item">
                <i class="fas fa-phone"></i> –¢–µ–ª–µ—Ñ–æ–Ω–∏—è
            </a>
            <a href="/static/conversations.html" class="sidebar-nav-item">
                <i class="fas fa-comments"></i> –î–∏–∞–ª–æ–≥–∏
            </a>

            <div class="sidebar-section">–ò–ò –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å</div>
            <a href="/static/voice_llm_interface/" class="sidebar-nav-item active">
                <i class="fas fa-gem"></i> JARVIS AI (Gemini)
            </a>

            <div class="sidebar-section">–ê–∫–∫–∞—É–Ω—Ç</div>
            <a href="/static/settings.html" class="sidebar-nav-item">
                <i class="fas fa-gear"></i> –ù–∞—Å—Ç—Ä–æ–π–∫–∏
            </a>
        </nav>

        <div class="sidebar-footer">
            <a href="https://voicyfy.ru/static/index.html" class="btn btn-secondary" style="width: 100%; text-decoration: none; justify-content: center;">
                <i class="fas fa-sign-out-alt"></i> –í—ã–π—Ç–∏
            </a>
        </div>
    </aside>

    <!-- CONFIG PANEL -->
    <div class="config-panel" id="configPanel">
        <div class="config-container">
            <div class="config-header">
                <button class="mobile-menu-toggle" id="mobile-menu-toggle">
                    <i class="fas fa-bars"></i>
                </button>
                <div class="config-icon">üíé</div>
                <div>
                    <div class="config-title">JARVIS AI + Gemini</div>
                    <div class="config-subtitle">–ì–æ–ª–æ—Å–æ–≤–æ–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –Ω–∞ –±–∞–∑–µ Google Gemini —Å LLM —Å—Ç—Ä–∏–º–∏–Ω–≥–æ–º</div>
                </div>
            </div>
            
            <div class="config-form">
                <div class="form-group">
                    <label class="form-label">üíé Gemini –ê—Å—Å–∏—Å—Ç–µ–Ω—Ç:</label>
                    <select class="form-select" id="assistantSelect">
                        <option value="">–ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–∞...</option>
                    </select>
                </div>
                
                <div class="config-actions">
                    <button class="btn btn-primary" id="saveBtn">
                        <i class="fas fa-save"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                    </button>
                    <button class="btn btn-success" id="testBtn" disabled>
                        <i class="fas fa-play"></i> –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å
                    </button>
                    <button class="btn btn-success" id="copyBtn" disabled>
                        <i class="fas fa-code"></i> –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Success Message -->
    <div class="success-message" id="successMessage">
        <i class="fas fa-check-circle" style="font-size: 20px;"></i>
        <span id="successText">–£—Å–ø–µ—à–Ω–æ!</span>
    </div>

    <!-- MAIN INTERFACE -->
    <canvas id="jarvis-three-canvas"></canvas>
    <div class="background-overlay"></div>
    
    <div class="main-container">
        <!-- HUD Frames -->
        <div class="hud-frame hud-tl" id="hudTL"></div>
        <div class="hud-frame hud-tr" id="hudTR"></div>
        <div class="hud-frame hud-bl" id="hudBL"></div>
        <div class="hud-frame hud-br" id="hudBR"></div>

        <!-- Header -->
        <div class="header">
            <div class="logo-icon">üíé</div>
            <div class="logo-text" id="headerTitle">JARVIS AI</div>
            <div class="header-subtitle" id="headerSubtitle">Gemini Voice + LLM Streaming</div>
        </div>

        <!-- Error Container -->
        <div class="error-container" id="errorContainer">
            <div class="error-icon">‚ö†Ô∏è</div>
            <div class="error-title" id="errorTitle">–û—à–∏–±–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏</div>
            <div class="error-text" id="errorText">–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞</div>
        </div>

        <!-- Content Container -->
        <div class="content-container">
            <!-- Left Panel - LLM Results -->
            <div class="llm-panel">
                <div class="llm-header">
                    <div class="llm-icon">ü§ñ</div>
                    <div class="llm-title">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ò–ò</div>
                    <div class="llm-meta" id="llmMeta">–û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞</div>
                    <button class="copy-button" id="copyLlmButton" style="display: none;">
                        <i class="fas fa-copy"></i>
                        <span id="copyButtonText">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</span>
                    </button>
                </div>
                <div class="llm-content" id="llmContent">
                    <div class="llm-placeholder" id="llmPlaceholder">
                        <span class="placeholder-icon">‚ú®</span>
                        <div class="placeholder-title">–ó–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å</div>
                        <div class="placeholder-text">
                            –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≥–æ–ª–æ—Å (–Ω–∞–∂–º–∏—Ç–µ –Ω–∞ —Å—Ñ–µ—Ä—É) –∏–ª–∏ –≤–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –Ω–∏–∂–µ.
                        </div>
                    </div>
                </div>
                
                <!-- –¢–µ–∫—Å—Ç–æ–≤—ã–π –≤–≤–æ–¥ -->
                <div class="chat-input-container">
                    <div class="chat-input-wrapper">
                        <input 
                            type="text" 
                            class="chat-input" 
                            id="chatInput" 
                            placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." 
                            autocomplete="off"
                        >
                        <button class="chat-send-btn" id="chatSendBtn" disabled>
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                    <div class="chat-context-info">
                        <span id="chatContextInfo">–ö–æ–Ω—Ç–µ–∫—Å—Ç: 0/5 —Å–æ–æ–±—â–µ–Ω–∏–π</span>
                        <button class="clear-history-btn" id="clearHistoryBtn" style="display: none;">
                            <i class="fas fa-trash-alt"></i> –û—á–∏—Å—Ç–∏—Ç—å
                        </button>
                    </div>
                </div>
            </div>

            <!-- Right Panel - Voice Assistant -->
            <div class="voice-panel">
                <div class="voice-header">
                    <div class="voice-icon">üíé</div>
                    <div class="voice-title">Gemini Voice</div>
                    <div class="voice-status connecting" id="voiceStatus">
                        <span class="status-dot"></span>
                        <span id="statusText">–û–∂–∏–¥–∞–Ω–∏–µ...</span>
                    </div>
                </div>
                <div class="voice-content">
                    <div class="jarvis-container">
                        <div class="jarvis-sphere" id="jarvisSphere">
                            <i class="fas fa-gem jarvis-icon"></i>
                            <div class="circular-visualizer" id="circularViz"></div>
                        </div>
                        
                        <!-- MUTE BUTTON -->
                        <button class="mute-button" id="muteButton" title="–û—Ç–∫–ª—é—á–∏—Ç—å –º–∏–∫—Ä–æ—Ñ–æ–Ω">
                            <i class="fas fa-microphone" id="muteIcon"></i>
                        </button>
                    </div>
                    
                    <!-- Mute Status Indicator -->
                    <div class="mute-status" id="muteStatus">
                        <i class="fas fa-microphone-slash"></i>
                        <span>–ú–∏–∫—Ä–æ—Ñ–æ–Ω –æ—Ç–∫–ª—é—á—ë–Ω</span>
                    </div>
                    
                    <div class="instructions">
                        <div class="instructions-title">–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å</div>
                        <div class="instructions-text">
                            –ù–∞–∂–º–∏—Ç–µ –Ω–∞ —Å—Ñ–µ—Ä—É –∏ –≥–æ–≤–æ—Ä–∏—Ç–µ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ —Å Gemini. 
                            –î–ª—è —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ —Ç–µ–∫—Å—Ç –±—É–¥–µ—Ç –ø–æ—è–≤–ª—è—Ç—å—Å—è –Ω–∞ —ç–∫—Ä–∞–Ω–µ.
                            <br><br>
                            <strong>üé§ Mute:</strong> –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞ —á—Ç–æ–±—ã –≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å –µ–≥–æ.
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- External JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    
    <!-- App JS (load in order) -->
    <script src="config.js"></script>
    <script src="audio.js"></script>
    <script src="main.js"></script>
</body>
</html>
